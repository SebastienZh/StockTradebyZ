# 网页端开发任务清单

## 1. 项目架构设计

### 1.1 技术栈选择
- [ ] **后端框架**: FastAPI (基于用户偏好)
- [ ] **前端框架**: React/Vue.js + TypeScript
- [ ] **数据库**: SQLite + SQLAlchemy (基于用户偏好)
- [ ] **任务调度**: APScheduler (基于用户偏好)
- [ ] **图表库**: 评估Chart.js、TradingView Lightweight Charts、D3.js等

### 1.2 项目结构设计
- [ ] 创建独立的web分支用于网页端开发
- [ ] 所有内容放在web/下
- [ ] 逐步迁移同时保证现有可用。将当前的所有内容复制到web/core/下，禁止在现有文件上开发。
- [ ] 设计前后端分离的目录结构
- [ ] 配置开发环境和构建工具

## 2. 后端API开发

### 2.1 核心API接口
- [ ] **股票数据API**
  - [ ] 获取股票列表接口
  - [ ] 获取K线数据接口 (OHLCV格式)
  - [ ] 获取RSV指标数据接口
  - [ ] 获取BBI指标数据接口
- [ ] **选股结果API**
  - [ ] 获取历史选股结果接口
  - [ ] 获取当日选股结果接口
  - [ ] 按策略筛选选股结果接口
- [ ] **回测数据API**
  - [ ] 获取回测结果接口
  - [ ] 获取策略表现统计接口

### 2.2 数据持久化
- [ ] 设计SQLite数据库表结构
  - [ ] 股票基础信息表 (包含公司名称)
  - [ ] K线数据表
  - [ ] 选股结果表
  - [ ] 回测结果表
  - [ ] 系统运行日志表
- [ ] 实现SQLAlchemy模型定义
- [ ] 数据迁移和初始化脚本

### 2.3 数据同步机制
- [ ] CSV数据导入到数据库的同步脚本
- [ ] 增量数据更新机制
- [ ] 数据一致性检查和修复

## 3. 定时任务系统

### 3.1 APScheduler集成
- [ ] 在FastAPI应用中集成APScheduler
- [ ] 配置北京时间下午4点的定时任务
- [ ] 实现任务状态监控和错误处理

### 3.2 自动化流程
- [ ] **数据获取任务**
  - [ ] 自动运行fetch_kline.py
  - [ ] 错误重试机制
  - [ ] 数据质量检查
- [ ] **选股任务**
  - [ ] 自动运行select_stock.py
  - [ ] 结果保存到数据库
  - [ ] 异常处理和通知
- [ ] **后台处理**
  - [ ] 非阻塞式任务执行
  - [ ] 任务队列管理
  - [ ] 进度跟踪和状态更新

### 3.3 任务监控
- [ ] 任务执行状态跟踪
- [ ] 执行日志记录
- [ ] 失败任务重试机制
- [ ] 任务执行时间统计

## 4. 前端界面开发

### 4.1 主要页面设计
- [ ] **仪表板页面**
  - [ ] 系统运行状态显示
  - [ ] 最新选股结果展示
  - [ ] 数据更新时间戳显示
  - [ ] 数据新鲜度指示器 (绿/黄/红色编码)
- [ ] **K线图表页面**
  - [ ] 交互式K线图表组件
  - [ ] 技术指标叠加显示 (RSV, BBI)
  - [ ] 时间范围选择器
  - [ ] 股票搜索和切换功能
- [ ] **选股结果页面**
  - [ ] 按策略分类显示
  - [ ] 股票详细信息展示 (代码+公司名称)
  - [ ] 历史选股记录查询
  - [ ] 导出功能

### 4.2 图表组件开发
- [ ] **K线图表组件**
  - [ ] 评估并选择最适合的图表库
  - [ ] 实现OHLCV数据渲染
  - [ ] 添加缩放和平移交互
  - [ ] 移动端响应式适配
- [ ] **技术指标图表**
  - [ ] RSV指标可视化
  - [ ] BBI线条显示
  - [ ] 多指标叠加显示
  - [ ] 自定义指标参数设置

### 4.3 用户体验优化
- [ ] 响应式设计 (支持移动端)
- [ ] 加载状态和进度指示
- [ ] 错误处理和用户友好提示
- [ ] 数据缓存和性能优化

## 5. 系统集成和部署

### 5.1 开发环境配置
- [ ] 创建独立的worktree分支
- [ ] 配置前后端开发服务器
- [ ] 设置热重载和调试环境
- [ ] 编写开发文档和启动说明

### 5.2 生产环境部署
- [ ] 生产环境配置文件
- [ ] 静态文件构建和部署
- [ ] 数据库初始化脚本
- [ ] 系统监控和日志配置

### 5.3 启动脚本优化
- [ ] 简化bat文件 (保持3个文件: CLI, UI, 系统检查)
- [ ] 每个bat文件只包含单个命令
- [ ] 清晰的UI启动说明文档
- [ ] 错误处理和用户提示

## 6. 测试和质量保证

### 6.1 单元测试
- [ ] API接口测试
- [ ] 数据模型测试
- [ ] 定时任务测试
- [ ] 前端组件测试

### 6.2 集成测试
- [ ] 端到端流程测试
- [ ] 数据同步测试
- [ ] 定时任务集成测试
- [ ] 性能测试

### 6.3 用户验收测试
- [ ] 功能完整性验证
- [ ] 用户界面易用性测试
- [ ] 移动端兼容性测试
- [ ] 错误场景处理测试

## 优先级说明

**高优先级 (P0)**:
- 后端API基础框架
- 数据库设计和数据同步
- 定时任务系统核心功能

**中优先级 (P1)**:
- K线图表组件
- 前端主要页面
- 系统监控和错误处理

**低优先级 (P2)**:
- 高级图表功能
- 移动端优化
- 性能优化和缓存

## 预估工期

- **架构设计和环境搭建**: 3-5天
- **后端API开发**: 7-10天
- **前端界面开发**: 10-15天
- **系统集成和测试**: 5-7天
- **总计**: 25-37天

## 技术风险和缓解措施

1. **图表库选择风险**: 提前进行技术调研和原型验证
2. **数据同步性能**: 实现增量更新和异步处理
3. **定时任务稳定性**: 完善错误处理和重试机制
4. **前端性能**: 实现数据分页和虚拟滚动
